SELECT *
FROM(
SELECT
DECODE(IS_DATE_DAPI(TO_CHAR(AEFF)),1,TO_DATE(TO_CHAR(AEFF),'YYYY-MM-DD'),TO_DATE('19000101','YYYY_MM_DD'))  AS PREMIUM_EFF_DATE,
ANAME,
AAC,
ASTATU,
DECODE(IS_DATE_DAPI(TO_CHAR(ADATE)),1,TO_DATE(TO_CHAR(ADATE),'YYYY-MM-DD'),TO_DATE('19000101','YYYY_MM_DD')) AS PROCESSING_DATE
FROM
MR_LFPDAF
WHERE
PNO =? AND ASTATU !='R' /*INPUT POLICY NO */
ORDER BY AEFF DESC 
)P 
WHERE ROWNUM=1
----
INPUT:
POLICY_NO : 302-8169005