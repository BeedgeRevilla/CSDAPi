SELECT	
	GTO.CDAGC   ,
	GTO.CDUNT   ,
	GTO.CDLVL   ,
	GTO.CDPOS   ,
	DECODE(IS_DATE_DAPI(TO_CHAR(CDPOSD)),1,TO_DATE(TO_CHAR(CDPOSD),'YYYY-MM-DD'),TO_DATE('19000101','YYYY-MM-DD')) AS CDPOSD, 		/* Added from UAT */
	GTO.CDROL   ,
	GTO.CDAGNTYP,
	GTO.CDCMG   ,
	--DECODE(IS_DATE(TO_CHAR(CDREF)),1,TO_DATE(TO_CHAR(CDREF),'YYYY-MM-DD'),TO_DATE('19000101','YYYY-MM-DD')) AS REGISTRATION_EFF_DATE,
	GTO.CDEXCOD ,
	GTO.CDEXRSN ,
	GTO.CDEHPF  ,
	GTO.CDDMAF  ,
	GTO.CDASPF  ,
	GTO.CDSTU   ,
	GTO.CDFNAM  ,
	(LPAD(GTO.CDUNT,6,0)||'-'||LPAD(GTO.CDLVL,2,0)||'-'||LPAD(GTO.CDAGC,6,0)) AS FULL_AGENT_CODE,
	--GTO.CDCMG,
	DECODE(IS_DATE_DAPI(TO_CHAR(GTO.CDCEFF)),1,TO_DATE(TO_CHAR(GTO.CDCEFF),'YYYY-MM-DD'),TO_DATE('19000101','YYYY-MM-DD')) AS EFFECTIVE_DATE,
	DECODE(IS_DATE_DAPI(TO_CHAR(GTO.CDTRMD)),1,TO_DATE(TO_CHAR(GTO.CDTRMD),'YYYY-MM-DD'),TO_DATE('19000101','YYYY-MM-DD')) AS TERMINATION_DATE,
	GTO.CDTRMC,
	GTO.CDRGN,
	CASE WHEN TO_CHAR(GTO.ODULLNO) IS NULL 
	THEN CASE WHEN TO_CHAR(CNR.LCNBR) IS NULL THEN '0000-00000' ELSE TO_CHAR(CNR.LCNBR) END
	END AS	AGENT_LICENSE_NUMBER ,  /* DATH-640:AGENT_LICENSE_NUMBER */				/* Added from DEV */
	GTO.ODULLNO	AS UL_LICENSE_NUMBER,/* DATH-18:UL_LICENSE_NUMBER */ 
	DECODE(IS_DATE_DAPI(TO_CHAR(GTO.ODULLEFFD)),1,TO_DATE(TO_CHAR(GTO.ODULLEFFD),'YYYY-MM-DD'),TO_DATE('19000101','YYYY-MM-DD')) AS UL_LICENSE_NO_EFFTVE_DATE, /* DATH-18:UL_LICENSE_EFFETCTIVE_DATE */
	GTO.CDDESC AS TERMINATION_DESC, /* DATH-18:AGENTS TERMINATION DESCRIPTION */	/* Added from DEV */
	
	GTO.CSTELC      ,
	GTO.CDRGN       ,
	GTO.CDLNAM      ,
	GTO.CDSTU       ,
	GTO.CDTRMD      ,
	GTO.CDCEFF      ,
	GTO.CDTRMC      ,
	GTO.CDTDES      ,
	CNR.LCRGN		,								/* Added from DEV */
	CNR.LCTAX 		,								/* Added from DEV */
	GTO.LOAD_MDE_CD ,
	GTO.SRC_STM_ID  ,
	GTO.COUNTRY_CD  
	
FROM 
MR_AGPODAGTO GTO 
LEFT OUTER JOIN 									/* Added from DEV */
MR_AGPLICNR CNR
ON GTO.CDAGC=CNR.LCAGC
WHERE
CDAGC = '%agentCode%'  	/*INPUT AGENT CODE */
--------
--INPUTS:
--AGENT_CODE : 20872