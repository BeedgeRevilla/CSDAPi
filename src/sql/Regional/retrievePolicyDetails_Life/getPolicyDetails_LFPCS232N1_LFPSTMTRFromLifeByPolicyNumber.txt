SELECT 
    CS232N1.NO_CLAIM_BONUS_AMOUNT,
	STMTR.NO_CLAIM_BONUS_DATE,
	
	
	STMTR.STADPUPB,
	STMTR.STADRPS,
	STMTR.STADRT,
	STMTR.STAGT1,
	STMTR.STAGT2,
	STMTR.STAJ01,
	STMTR.STAJ02,
	STMTR.STAJ03,
	STMTR.STAJ04,
	STMTR.STAJ05,
	STMTR.STAJ06,
	STMTR.STAJ07,
	STMTR.STAJ08,
	STMTR.STAJ09,
	STMTR.STAJ10,
	STMTR.STAPUE,
	STMTR.STAPUP,
	STMTR.STBENADJ,
	STMTR.STCAGT,
	STMTR.STCPN,
	STMTR.STCPNB,
	STMTR.STCPND,
	STMTR.STCPNI,
	STMTR.STCPOL,
	STMTR.STCPUP,
	STMTR.STCSCD,
	STMTR.STCSCPS,
	STMTR.STDCRM,
	STMTR.STDUE,
	STMTR.STDVD,
	STMTR.STDVDB,
	STMTR.STDVDC,
	STMTR.STDVDE,
	STMTR.STDVDI,
	STMTR.STDVDIN,
	STMTR.STDVDO,
	STMTR.STDVDWN,
	STMTR.STETID,
	STMTR.STFPD,
	STMTR.STFPDB,
	STMTR.STFPDI,
	STMTR.STFPDIN,
	STMTR.STFPDWN,
	STMTR.STHAD1,
	STMTR.STHAD2,
	STMTR.STHAD3,
	STMTR.STHAD4,
	STMTR.STINXO,
	STMTR.STLN,
	STMTR.STLNI,
	STMTR.STLNIN,
	STMTR.STLNWN,
	STMTR.STLOC,
	STMTR.STMAE,
	STMTR.STMAED,
	STMTR.STMAEO,
	STMTR.STMPF,
	STMTR.STMTH,
	STMTR.STMTHD,
	STMTR.STNDTE,
	STMTR.STNME,
	STMTR.STNMEF,
	STMTR.STPCCY,
	STMTR.STPCO,
	STMTR.STPDVDP,
	STMTR.STPEFF,
	STMTR.STPHNM,
	STMTR.STPHNMF,
	STMTR.STPLAN,
	STMTR.STPLND,
	STMTR.STPLNN,
	STMTR.STPLNP,
	STMTR.STPMDE,
	STMTR.STPMGI,
	STMTR.STPNO,
	STMTR.STPREM,
	STMTR.STPS1,
	STMTR.STPS2,
	STMTR.STPS3,
	STMTR.STPS4,
	STMTR.STPS5,
	STMTR.STPS6,
	STMTR.STPTYP,
	STMTR.STPWAS,
	STMTR.STQFLG,
	STMTR.STRB,
	STMTR.STRBCV,
	STMTR.STRBF,
	STMTR.STRBL,
	STMTR.STRNSDT,
	STMTR.STRPUSA,
	STMTR.STSIB,
	STMTR.STSRVL,
	STMTR.STTB,
	STMTR.STTBCV,
	STMTR.STTBL,
	STMTR.STTPROBNF,
	STMTR.STVDVDPB,
	STMTR.STVFPDPB,
	STMTR.STVLNPB,
	CS232N1.CSPNO,
	CS232N1.CSDAT,
	CS232N1.CSACOIA,
	CS232N1.CSACTB,
	CS232N1.CSBBAMT,
	CS232N1.CSBBEXPDT,
	CS232N1.CSDSP,
	CS232N1.CSFDW,
	CS232N1.CSHP,
	CS232N1.CSIRAD,
	CS232N1.CSIRPL,
	CS232N1.CSLDSP,
	CS232N1.CSLOC,
	CS232N1.CSMEPLN,
	CS232N1.CSMHP,
	CS232N1.CSNCDF,
	CS232N1.CSPAD,
	CS232N1.CSPAIA,
	CS232N1.CSPIOC,
	CS232N1.CSPRMA,
	CS232N1.CSPRMB,
	CS232N1.CSPSC,
	CS232N1.CSPTYP,
	CS232N1.CSRDSP,
	CS232N1.CSTACTB,
	CS232N1.CSTDSP,
	CS232N1.CSTPSV
FROM
	(
	SELECT
		DECODE(IS_DATE_DAPI(TO_CHAR(STADTE)),1,TO_DATE(TO_CHAR(STADTE),'YYYY-MM-DD'),TO_DATE('19000101','YYYY-MM-DD')) AS NO_CLAIM_BONUS_DATE,
		STADPUPB,
		STADRPS,
		STADRT,
		STAGT1,
		STAGT2,
		STAJ01,
		STAJ02,
		STAJ03,
		STAJ04,
		STAJ05,
		STAJ06,
		STAJ07,
		STAJ08,
		STAJ09,
		STAJ10,
		STAPUE,
		STAPUP,
		STBENADJ,
		STCAGT,
		STCPN,
		STCPNB,
		STCPND,
		STCPNI,
		STCPOL,
		STCPUP,
		STCSCD,
		STCSCPS,
		STDCRM,
		STDUE,
		STDVD,
		STDVDB,
		STDVDC,
		STDVDE,
		STDVDI,
		STDVDIN,
		STDVDO,
		STDVDWN,
		STETID,
		STFPD,
		STFPDB,
		STFPDI,
		STFPDIN,
		STFPDWN,
		STHAD1,
		STHAD2,
		STHAD3,
		STHAD4,
		STINXO,
		STLN,
		STLNI,
		STLNIN,
		STLNWN,
		STLOC,
		STMAE,
		STMAED,
		STMAEO,
		STMPF,
		STMTH,
		STMTHD,
		STNDTE,
		STNME,
		STNMEF,
		STPCCY,
		STPCO,
		STPDVDP,
		STPEFF,
		STPHNM,
		STPHNMF,
		STPLAN,
		STPLND,
		STPLNN,
		STPLNP,
		STPMDE,
		STPMGI,
		STPNO,
		STPREM,
		STPS1,
		STPS2,
		STPS3,
		STPS4,
		STPS5,
		STPS6,
		STPTYP,
		STPWAS,
		STQFLG,
		STRB,
		STRBCV,
		STRBF,
		STRBL,
		STRNSDT,
		STRPUSA,
		STSIB,
		STSRVL,
		STTB,
		STTBCV,
		STTBL,
		STTPROBNF,
		STVDVDPB,
		STVFPDPB,
		STVLNPB,
	ROW_NUMBER() OVER (PARTITION BY STPNO ORDER BY STNDTE DESC) AS REC
	FROM VW_CLAIM_BONUS
	WHERE STPNO='%policyNumber%' /*INPUT POLICY NUMBER*/
	AND DECODE(IS_DATE_DAPI(TO_CHAR(STNDTE)),1,TO_DATE(TO_CHAR(STNDTE),'YYYY-MM-DD'),TO_DATE('19000101','YYYY-MM-DD'))>= TO_DATE('1900-01-01','YYYY-MM-DD') 	/* INPUT POLICY EFFECTIVE FROM DATE */
	AND DECODE(IS_DATE_DAPI(TO_CHAR(STNDTE)),1,TO_DATE(TO_CHAR(STNDTE),'YYYY-MM-DD'),TO_DATE('19000101','YYYY-MM-DD')) <= TO_DATE(TO_CHAR(SYSDATE,'YYYY-MM-DD'),'YYYY-MM-DD')	/* INPUT POLICY_EFFECTIVE_TO_DATE */
	)STMTR
	LEFT OUTER JOIN
	(
		SELECT
			CSNCDA AS NO_CLAIM_BONUS_AMOUNT,
			CSPNO,
			CSDAT,
			CSACOIA,
			CSACTB,
			CSBBAMT,
			CSBBEXPDT,
			CSDSP,
			CSFDW,
			CSHP,
			CSIRAD,
			CSIRPL,
			CSLDSP,
			CSLOC,
			CSMEPLN,
			CSMHP,
			CSNCDF,
			CSPAD,
			CSPAIA,
			CSPIOC,
			CSPRMA,
			CSPRMB,
			CSPSC,
			CSPTYP,
			CSRDSP,
			CSTACTB,
			CSTDSP,
			CSTPSV
			FROM
		MR_LFPCS232N1
	WHERE CSPNO='%policyNumber%' /*INPUT POLICY NUMBER*/
	)CS232N1
	ON STMTR.STPNO=CS232N1.CSPNO
	AND STMTR.STNDTE=CS232N1.CSDAT
WHERE STMTR.REC=1
------
--INPUTS:
--POLICY_NUMBER : 302-8169005
--POLICY_EFFECTIVE_FROM_DATE : 1900-01-01
--POLICY_EFFECTIVE_TO_DATE : 2019-09-25