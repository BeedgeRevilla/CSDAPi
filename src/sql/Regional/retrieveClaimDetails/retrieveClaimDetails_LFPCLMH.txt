SELECT	
	HCLMNO,
	PNO,
	HCTYPE,
	HCSTU,
	HCCCY , 
	DECODE(IS_DATE_DAPI(TO_CHAR(HCDOS)),1,TO_DATE(TO_CHAR(HCDOS),'YYYY-MM-DD'),TO_DATE('19000101','YYYY-MM-DD')) AS SUBMISSION_DATE,
	CASE WHEN HCSTU='P' OR HCSTU='A' 
		THEN DECODE(IS_DATE_DAPI(TO_CHAR(HCDOP)),1,TO_DATE(TO_CHAR(HCDOP),'YYYY-MM-DD'),TO_DATE('19000101','YYYY-MM-DD')) 
		ELSE DECODE(IS_DATE_DAPI(TO_CHAR(HCDOT)),1,TO_DATE(TO_CHAR(HCDOT),'YYYY-MM-DD'),TO_DATE('19000101','YYYY-MM-DD')) 
	END AS COMPLETION_DATE, /*DAHK - 4267 */
	HCDIA , 
	DECODE(IS_DATE_DAPI(TO_CHAR(HCDOAD)),1,TO_DATE(TO_CHAR(HCDOAD),'YYYY-MM-DD'),TO_DATE('19000101','YYYY-MM-DD')) AS ADMISSION_DATE,
	DECODE(IS_DATE_DAPI(TO_CHAR(HCDODS)),1,TO_DATE(TO_CHAR(HCDODS),'YYYY-MM-DD'),TO_DATE('19000101','YYYY-MM-DD')) AS DATE_OF_DISCHARGE,
	(HCAPR1 || HCAPR2) AS APPROVAL_REMARK,
	HCREA,
	/*DAHK 1431*/
	HCPDT 	AS PRODUCT_TYPE, 
	HCREM 	AS REMARK, 
	HCLTER 	AS LETTER_CODE, 
	HCPLAN 	AS PLAN_CODE, 
	DECODE(IS_DATE_DAPI(TO_CHAR(HCDBNF)),1,TO_DATE(TO_CHAR(HCDBNF),'YYYY-MM-DD'),TO_DATE('19000101','YYYY-MM-DD')) 	AS BNF_EFF_DATE, 
	HCPCCY 	AS POLICY_CCY, 
	HCBCCY 	AS RECEIPT_CCY,
	HCOTOT 	AS OTH_INS_TOTAL_AMT, 
	HCCUSR 	AS CAPTURE_CLAIM_USER_ID, 
	HCNLNG 	AS CN_LANGUAGE, 
	HCLDISF AS SAME_DISABILITY_FLAG,
	HCAPR1 	AS APPROVAL_REMARK_1, 
	HCAPR2 	AS APPROVAL_REMARK_2,	
	HCRNRK 	AS RENEWAL_REMARK, 
	HCRNRC 	AS RENEWAL_REMARK_CODE,
	HCHOSP 	AS HOSPITAL_CODE, 
	HCDRCD 	AS DOCTOR_CODE, 	
	HCSURG 	AS SURGICAL_CODE, 	
	/*DAHK - 4267 */
	DECODE(IS_DATE_DAPI(TO_CHAR(HCDOP)),1,TO_DATE(TO_CHAR(HCDOP),'YYYY-MM-DD'),TO_DATE('19000101','YYYY-MM-DD')) AS PAYMENT_DATE,
	DECODE(IS_DATE_DAPI(TO_CHAR(HCDOT)),1,TO_DATE(TO_CHAR(HCDOT),'YYYY-MM-DD'),TO_DATE('19000101','YYYY-MM-DD')) AS TRANSACTION_DATE,
	LHDESC, /* DATH-416 */	
	/*DAHK - 44864 */
	(HCHIP+ HCHCP+ HCRBP+ HCICP+ HCHEP+ HCPVIP+ HCINPP+ HCSGP+ HCANAP+ HCOTP+ HCAAP+ HCOPSP+ HCEOPP+ HCRDCP+ HCKDNP+ HCT1P+ HCMNP+ HCSMMP+ HCNBPR+ HCNBPC+ HCNBC+ HCPREM+ HCPCH+ HCCOI+ HCAMC+ HCOKDP+ HCOCAP+ HCLSCP+ HCIOTP+ HCHCAP+ HCSCAP+ 
    HCDTAP+ HCAMSP+ HCPHTP+ HCADTP+ HCPSTP+ HCEMAP+ HCIPAP+HCCDAP+ HCBCTP+ HCIGBAP+ HCPHCAP+ HCPDAP+ HCNTAP+ HCMDAP+ HCRBWAP) AS TOT_PAID_AMOUNT,
	DECODE(IS_DATE_DAPI(TO_CHAR(HCNBSD)),1,TO_DATE(TO_CHAR(HCNBSD),'YYYY-MM-DD'),TO_DATE('19000101','YYYY-MM-DD')) AS NCB_PERIOD_START_DT,
	DECODE(IS_DATE_DAPI(TO_CHAR(HCNBED)),1,TO_DATE(TO_CHAR(HCNBED),'YYYY-MM-DD'),TO_DATE('19000101','YYYY-MM-DD')) AS NCB_PERIOD_END_DT,
  HCASOR AS ASSESSOR_NAME	
  
	/* DASI: commented out to reduce duration of query execution [as review point by
  technical lead
  DEPNO,	
	HCHIP,
	HCHIDC,
	HCHIDP,
	HCHIRM,
	HCHCP,
	HCHCDC,
	HCHCDP,
	HCHCRM,
	HCRBB,
	HCRBC,
	HCRBP,
	HCRBDY,
	HCRBRM,
	HCICB,
	HCICC,
	HCICP,
	HCICDY,
	HCICRM,
	HCHEB,
	HCHEC,
	HCHEP,
	HCHERM,
	HCPVIB,
	HCPVIC,
	HCPVIP,
	HCPVID,
	HCPIRM,
	HCINPB,
	HCINPC,
	HCINPP,
	HCINRM,
	HCSGB,
	HCSGC,
	HCSGP,
	HCSGPC,
	HCSGRM,
	HCANAB,
	HCANAC,
	HCANAP,
	HCANAR,
	HCOTB,
	HCOTC,
	HCOTP,
	HCOTR,
	HCAAB,
	HCAAC,
	HCAAP,
	HCAARM,
	HCOPSB,
	HCOPS,
	HCOPSP,
	HCOPPC,
	HCOSRM,
	HCEOPB,
	HCEOPC,
	HCEOPP,
	HCEORM,
	HCRDCB,
	HCRDCC,
	HCRDCP,
	HCRCRM,
	HCKDNB,
	HCKDNC,
	HCKDNP,
	HCKDRM,
	HCT1C,
	HCT1P,
	HCT1D,
	HCT1RM,
	HCMNB,
	HCMNC,
	HCMNP,
	HCMNRM,
	HCSMMB,
	HCSMMC,
	HCSMMP,
	HCSMMR,
	HCNBPR,
	HCNBPC,
	HCNBC,
	HCPFLG,
	HCPREM,
	HCPTD,
	HCPCH,
	HCCOI,
	HCAMC,
	HCCOID,
	HCRPY,
	HCOKDB,
	HCOKDC,
	HCOKDP,
	HCOKDR,
	HCOCB,
	HCOCAC,
	HCOCAP,
	HCOCRM,
	HCLSCB,
	HCLSCC,
	HCLSCP,
	HCLSCR,
	HCIOTB,
	HCIOTC,
	HCIOTP,
	HCIOTR,
	HCHCB,
	HCHCAC,
	HCHCAP,
	HCHCMD,
	HCCORM,
	HCSCB,
	HCSCAC,
	HCSCAP,
	HCSCRM,
	HCDTB,
	HCDTAC,
	HCDTAP,
	HCDTRM,
	HCAMSB,
	HCAMSC,
	HCAMSP,
	HCAMSR,
	HCPHTB,
	HCPHTC,
	HCPHTP,
	HCPHTR,
	HCADTB,
	HCADTC,
	HCADTP,
	HCADTR,
	HCPSTB,
	HCPSTC,
	HCPSTP,
	HCPSTR,
	HCEMAB,
	HCEMAC,
	HCEMAP,
	HCEMAR,
	HCIPB,
	HCIPAC,
	HCIPAP,
	HCIPRM,
	HCCDB,
	HCCDAC,
	HCCDAP,
	HCCDRM,
	HCBCTB,
	HCBCTC,
	HCBCTP,
	HCBCTR,
	HCIGBB,
	HCIGBAC,
	HCIGBAP,
	HCIGBRM,
	HCPHCB,
	HCPHCAC,
	HCPHCAP,
	HCPHCRM,
	HCPDB,
	HCPDAC,
	HCPDAP,
	HCPDRM,
	HCNTB,
	HCNTAC,
	HCNTAP,
	HCNTRM,
	HCMDB,
	HCMDAC,
	HCMDAP,
	HCMDDP,
	HCMDRM,
	HCRBWB,
	HCRBWAC,
	HCRBWAP,
	HCRBWDP,
	HCRBWRM,
	--HCHIO,
	--HCHCO,
	HCRBO,
	HCICO,
	HCHEO,
	HCPVIO,
	HCINPO,
	HCSGO,
	HCANAO,
	HCOTO,
	HCAAO,
	HCOPSO,
	HCEOPO,
	HCRDCO,
	HCKDNO,
	HCT1O,
	HCMNCO,
	HCSMMO,
	HCOKDO,
	HCOCAO,
	HCLSCO,
	HCIOTO,
	HCHCAO,
	HCSCAO,
	HCDTAO,
	HCAMSO,
	HCPHTO,
	HCADTO,
	HCPSTO,
	HCEMAO,
	HCIPAO,
	HCCDAO,
	HCBCTO,
	HCRBWO,
	HCMDO,
	HCPDO,
	HCNTO,
	HCPHPO,
	HCIGBO,	
	HCSURD,
	LHCOT1
	LHCOT2,
	LHCOT3,
	LHCOT4,
	LHCOT5,
	LHCTYP,
	LHHDG,
	LHLANG,
	LHLETC   */
FROM MR_LFPCLMH
LEFT OUTER JOIN MR_LFPCLMLH
ON LHCTYP=HCTYPE
AND LHLETC=(HCSTU||HCLTER)
WHERE HCLMNO = '%claimNumber%'	/*INPUT CLAIM NUMBER*/ 
AND PNO='%policyNumber%' /*INPUT POLICY NUMBER*/ /*DAHK-3403*/
