SELECT GPGE.* FROM
    (SELECT
     GENPKEY,
     TRANNO,
     LISTAGG(TO_CHAR(GENPLINE),' ') WITHIN GROUP (ORDER BY SEQNOGP) AS GENPLINE,
     ROW_NUMBER() OVER (PARTITION BY GENPKEY ORDER BY TRANNO DESC) AS RN
     FROM MR_GPGEPF
     WHERE GENPTYPE IN (CASE WHEN '${LOB}'='G400' THEN '08' WHEN '${LOB}'='GASIA' THEN '06' ELSE NULL END)
     GROUP BY GENPKEY, TRANNO
    ) GPGE 
   WHERE RN=1 and genpkey = '${GENPKEY}'